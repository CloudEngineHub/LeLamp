# LeLamp Troubleshooting Guide

This guide covers common issues encountered during LeLamp assembly and operation, with step-by-step solutions.

## Hardware Issues

### Servo Problems

**Problem**: Servo not responding or moving erratically
- **Check power supply**: Ensure 5V supply provides adequate current for all servos
- **Verify connections**: Check servo driver to servo cable connections
- **Test individual servos**: Disconnect other servos and test one at a time
- **Check servo IDs**: Run `uv run lerobot-find-port` to verify servo driver connection
- **Reset servo settings**: Re-run the motor setup script from scratch

**Problem**: Servo making grinding noises
- **Check for obstructions**: Ensure no 3D print supports or debris block movement
- **Verify servo horn alignment**: Incorrect horn position can cause binding
- **Check mechanical stress**: Ensure arms are properly aligned and not over-torqued

**Problem**: Intermittent servo movement
- **Check power supply voltage**: Use multimeter to verify stable 5V under load
- **Inspect cable connections**: Look for loose or damaged servo cables
- **Test at lower speeds**: Rapid movements may cause voltage drops

### Electronics Issues

**Problem**: Pi Zero 2W not booting
- **Check SD card**: Ensure proper OS image and card not corrupted
- **Verify power supply**: Pi needs stable 5V, check buck converter output
- **Check connections**: Ensure micro USB power cable is properly connected
- **Try different SD card**: Use a known-good card with fresh OS image

**Problem**: Camera not detected
- **Check ribbon cable**: Ensure camera cable is properly seated in Pi connector
- **Enable camera**: Run `sudo raspi-config` and enable camera interface
- **Test with libcamera**: Run `libcamera-hello` to verify camera functionality
- **Check for damage**: Inspect ribbon cable for tears or bent pins

**Problem**: Audio not working (ReSpeaker Hat)
- **Verify HAT connection**: Ensure ReSpeaker is properly seated on Pi headers
- **Check device tree overlay**: Verify overlay installation with `aplay -l`
- **Reinstall audio drivers**: Follow ReSpeaker setup steps again
- **Test with alsamixer**: Adjust audio levels and check device recognition

**Problem**: LED ring not lighting
- **Check power connections**: Verify 5V power to LED ring
- **Test data line**: Ensure GPIO pin connection is secure
- **Run LED test**: Use `sudo uv run -m lelamp.test.test_rgb`
- **Check for damaged LEDs**: Individual LEDs can fail and break the chain

### 3D Printing Issues

**Problem**: Parts don't fit together properly
- **Check print scale**: Ensure parts printed at 100% scale
- **Verify layer height**: Use 0.2mm or finer for critical tolerance parts
- **Post-process parts**: Remove support material and sand contact surfaces
- **Check printer calibration**: Ensure X/Y/Z steps are properly calibrated

**Problem**: Heat inserts won't stay in place
- **Use proper temperature**: Heat insert tool should reach 200-250Â°C
- **Proper technique**: Insert slowly and steadily, don't rush
- **Check hole size**: Verify 3D model holes are correct diameter
- **Consider thread locker**: Use low-strength thread locker if inserts are loose

## Software Issues

### Pi Setup Problems

**Problem**: Cannot SSH into Pi
- **Check network connection**: Verify Pi is connected to WiFi
- **Verify SSH enabled**: Ensure SSH was enabled during OS setup
- **Check hostname**: Try IP address instead of hostname.local
- **Firewall issues**: Temporarily disable computer firewall for testing

**Problem**: Runtime installation fails
- **Check internet connection**: Ensure Pi has stable internet access
- **Update system**: Run `sudo apt update && sudo apt upgrade` first
- **Install uv manually**: Follow official uv installation instructions
- **Check disk space**: Ensure sufficient space on SD card (16GB+ recommended)

**Problem**: Permission errors during testing
- **Use sudo for hardware tests**: RGB and some sensor tests require root access
- **Check user groups**: Add pi user to gpio, i2c, spi groups
- **Verify device permissions**: Check /dev/ device file permissions

### Known Issues and Workarounds

**LeRobot Compatibility Issue** (docs/3. Lamp Head.md:185)
- **Status**: [Active issue #1738](https://github.com/huggingface/lerobot/issues/1738)
- **Impact**: Cannot use LeRobot directly on Raspberry Pi
- **Workaround**: Use LeLamp runtime which includes compatibility fixes
- **Alternative**: Set up servo control from external computer via USB

## Diagnostic Commands

### System Health Checks
```bash
# Check system resources
free -h
df -h
vcgencmd get_throttled

# Check hardware interfaces
lsusb
i2cdetect -y 1
gpio readall

# Test camera
libcamera-hello --timeout 2000

# Check audio devices
aplay -l
arecord -l
```

### Servo Diagnostics
```bash
# Find servo driver port
uv run lerobot-find-port

# Test servo connectivity
uv run -m lelamp.test.test_motors --id lelamp --port /dev/ttyUSB0

# Manual servo control (replace port)
uv run -m lelamp.control --id lelamp --port /dev/ttyUSB0
```

### Network and Software
```bash
# Check network connectivity
ping google.com
ip addr show

# Verify Python environment
which uv
uv --version
python3 --version

# Check service status
systemctl status ssh
systemctl status networking
```

## Getting Additional Help

### Before Asking for Help
1. **Check this troubleshooting guide** thoroughly
2. **Search existing GitHub issues** for similar problems
3. **Collect diagnostic information** using commands above
4. **Take clear photos** of your setup if hardware-related

### Where to Get Help
- **GitHub Issues**: https://github.com/humancomputerlab/le_lamp/issues
- **Discord Community**: https://discord.gg/4hmNW3Ep
- **LeLamp Runtime Issues**: https://github.com/humancomputerlab/lelamp_runtime/issues

### What Information to Include
- **Problem description**: Clear, specific description of the issue
- **Steps to reproduce**: Exact sequence that leads to the problem
- **Error messages**: Complete error text, not screenshots of text
- **System information**: Pi model, OS version, hardware configuration
- **Photos**: Clear images of your setup for hardware issues

## Component Testing Order

When diagnosing issues, test components in this order:

1. **Power supply**: Verify voltage and current capacity
2. **Individual servos**: Test each servo separately
3. **Servo driver**: Verify communication and control
4. **Pi connectivity**: Ensure SSH and basic operation
5. **Individual sensors**: Camera, microphone, speakers separately
6. **Integrated systems**: Full lamp operation

This systematic approach helps isolate problems and avoid cascading failures.

---

**Previous**: [5. Lamp Control](./5.%20Lamp%20Control.md) | **Next**: [Testing Guide](./7.%20Testing%20Guide.md)